import pandas as pd

# weather data
data = {
    "Date": pd.date_range(start="2024-01-01", periods=20, freq="D"),
    "Season": [
        "Winter", "Winter", "Spring", "Spring", "Summer", "Summer",
        "Autumn", "Autumn", "Winter", "Spring",
        "Summer", "Autumn", "Winter", "Spring", "Summer", "Autumn",
        "Winter", "Spring", "Summer", "Autumn"
    ],
    "Temperature": [5, 7, 15, 18, 30, 33, 20, 22, 6, 16,
                    29, 19, 4, 17, 31, 21, 3, 14, 32, 23],
    "Humidity": [85, 80, 70, 65, 55, 50, 60, 58, 82, 68,
                 53, 61, 87, 66, 52, 59, 90, 72, 51, 60],
    "WindSpeed": [10, 12, 8, 15, 20, 18, 14, 16, 11, 13,
                  22, 17, 9, 12, 19, 15, 10, 14, 21, 18],
    "RainTomorrow": [
        "No", "Yes", "No", "Yes", "No", "No",
        "Yes", "No", "Yes", "No",
        "No", "Yes", "Yes", "No", "No", "Yes",
        "Yes", "No", "No", "Yes"
    ]
}

# Create DataFrame
df = pd.DataFrame(data)

# Save to CSV
df.to_csv("weather_classification.csv", index=False)

print("weather_classification.csv file created!")
print(df.head())

# Install required libraries (run only once)
# !pip install pandas scikit-learn matplotlib
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import OneHotEncoder
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline
from sklearn.tree import DecisionTreeClassifier, plot_tree
from sklearn.metrics import accuracy_score, classification_report
import matplotlib.pyplot as plt
# Load the dataset (make sure the CSV is in your working directory)
df = pd.read_csv("weather_classification.csv")

# Show first few rows
print(df.head())
# Drop 'RainTomorrow' and 'Date' from features
X = df.drop(columns=["RainTomorrow", "Date"])

# Set target variable
y = df["RainTomorrow"]
# Categorical column(s)
cat_cols = ["Season"]

# Numerical columns
num_cols = [c for c in X.columns if c not in cat_cols]

print("Categorical columns:", cat_cols)
print("Numerical columns:", num_cols)
# One-hot encode categorical variables, pass through numeric ones
preprocessor = ColumnTransformer([("cat", OneHotEncoder(handle_unknown="ignore"), cat_cols),("num", "passthrough", num_cols)])
# Split dataset into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y,test_size=0.25,random_state=42,stratify=y)
# Build the model
model = DecisionTreeClassifier(criterion="entropy",max_depth=4,random_state=42)
# Combine preprocessing and model into a pipeline
pipeline = Pipeline([("prep", preprocessor),("model", model)])
# Fit the pipeline on training data
pipeline.fit(X_train, y_train)
